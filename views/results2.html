<div class="center-panel">
    <h2>This is the Result editor</h2>  
    <p class="lead">View results, add new or delete an existing entries.</p>
    <div class="panel panel-default">
        <div class="panel-heading"
            ng-click="collapseAddResultsForm = !collapseAddResultsForm"><a role="button">Add new results</a></div>
        <div class="panel-body" uib-collapse="collapseAddResultsForm">
            <form class="form-horizontal" ng-submit="saveRace()">		
				<fieldset>			
					<legend>Race Details</legend>
					<div class="form-group">
						<label class="col-sm-2 control-label" for="event">Event</label>
						<div class="col-sm-3">
							<div class="input-group">
								<select class="form-control" id="event" ng-change="eventChanged()" ng-model="eventId"
									ng-options="e.id as e.name for e in events" ng-required="true">
									<option value="0">Please select...</option>
								</select>
							</div>
						</div>
						<label class="col-sm-2 control-label" for="existingRaceDate">Date</label>
						 <div class="col-sm-3">
							<div class="input-group">
								<select class="form-control" id="existingRaceDate" ng-model="race"
									ng-options="r as (r.date + (r.description != null ? ' ' + r.description : '')) for r in races" ng-required="true" ng-change="isNewRace = false"></select>
								<span class="input-group-btn">
									<button class="btn btn-default" type="button" ng-click="isNewRace = true">
										<i class="glyphicon glyphicon-plus"></i>
									</button>
								</span>							
							</div>
						</div>
						<div class="col-sm-2" >
							<p class="input-group" ng-show="isNewRace">
								<input class="form-control" close-text="Close" is-open="calendarStatus.opened"
									ng-model="newRace.date" ng-required="true" type="text"
									uib-datepicker-popup="dd-MMMM-yyyy"/>
								<span class="input-group-btn">
									<button class="btn btn-default" ng-click="calendarStatus.opened = true"
										type="button">
										<i class="glyphicon glyphicon-calendar"></i>
									</button>
								</span>
							</p>
						</div>
					</div>	
				</fieldset>
				<fieldset ng-show="isNewRace">
					<legend>Add A New Race</legend>				
					<div class="form-group">
						<label class="col-sm-2 control-label" for="course">Course</label>
						<div class="col-sm-4">			
							<select class="form-control" id="course" ng-model="newRace.courseId"
									ng-options="e.id as e.courseNumber for e in courses" ng-required="false"></select>
						</div>
						<label class="col-sm-2 control-label" for="conditions">Conditions</label>
						<div class="col-sm-4">				
								<input id="conditions" class="form-control" ng-model="newRace.conditions" ng-required="false" type="text" placeholder="e.g. Weather conditions, ascent climbed (fell) etc">
						</div>
					</div>
					<div class="form-group">
						<label class="col-sm-2 control-label" for="description">Name / Description</label>
						<div class="col-sm-4">
							<input id="description" class="form-control" ng-model="newRace.description" ng-required="false" type="text" placeholder="e.g. Senior Men, U17 Ladies, Fun run">
						</div>
						<label class="col-sm-2 control-label" for="venue">Venue</label>
						<div class="col-sm-4">
							<input id="venue" class="form-control" ng-model="newRace.venue" ng-required="false" type="text" placeholder="e.g. Northgate Sports Centre, London Hyde Park">
						</div>
					</div>
					<div class="form-group">
						<label class="col-sm-2 control-label" for="country">Country</label>
						<div class="col-sm-4">
							<select class="form-control" id="country" ng-model="newRace.countryCode"
									ng-options="c.code as c.name for c in countries" ng-required="false"></select>
						</div>
						<label class="col-sm-2 control-label" for="grandPrix">Is Grand Prix Race?</label>
						<div class="col-sm-4">
							<div class="checkbox">
								<input id="grandPrix" ng-model="newRace.isGrandPrixRace" type="checkbox">
							</div>
						</div>
					</div>
					<div class="form-group" uib-collapse="newRace.countryCode != 'GB'">
						<label class="col-sm-2 control-label" for="county">English County</label>
						<div class="col-sm-4">
							  <select class="form-control" id="county" ng-model="newRace.county" ng-required="false">
									<option value="">Please Select...</option>
									<option value="Berkshire">Berkshire</option>
									<option value="Buckinghamshire">Buckinghamshire</option>
									<option value="Cambridgeshire">Cambridgeshire</option>
									<option value="Cheshire">Cheshire</option>
									<option value="Cornwall">Cornwall</option>
									<option value="Cumberland">Cumberland</option>
									<option value="Derbyshire">Derbyshire</option>
									<option value="Devon">Devon</option>
									<option value="Dorset">Dorset</option>
									<option value="Durham">Durham</option>
									<option value="Essex">Essex</option>
									<option value="Gloucestershire">Gloucestershire</option>
									<option value="Hampshire">Hampshire</option>
									<option value="Herefordshire">Herefordshire</option>
									<option value="Hertfordshire">Hertfordshire</option>
									<option value="Kent">Kent</option>
									<option value="Lancashire">Lancashire</option>
									<option value="Leicestershire">Leicestershire</option>
									<option value="Lincolnshire">Lincolnshire</option>
									<option value="London">London</option>
									<option value="Middlesex">Middlesex</option>
									<option value="Norfolk">Norfolk</option>
									<option value="Northamptonshire">Northamptonshire</option>
									<option value="Northumberland">Northumberland</option>
									<option value="Nottinghamshire">Nottinghamshire</option>
									<option value="Oxfordshire">Oxfordshire</option>
									<option value="Rutland">Rutland</option>
									<option value="Shropshire">Shropshire</option>
									<option value="Somerset">Somerset</option>
									<option value="Staffordshire">Staffordshire</option>
									<option value="Suffolk">Suffolk</option>
									<option value="Surrey">Surrey</option>
									<option value="Sussex">Sussex</option>
									<option value="Warwickshire">Warwickshire</option>
									<option value="Wiltshire">Wiltshire</option>
									<option value="Worcestershire">Worcestershire</option>
									<option value="Yorkshire">Yorkshire</option>
									<option value="Wales">Wales</option>
									<option value="Scotland">Scotland</option>
									<option value="Ireland">Ireland</option>
									<option value="Northern Ireland">Northern Ireland</option>
								</select>
						</div>
						<label class="col-sm-2 control-label" for="area">Area</label>
						<div class="col-sm-4">
							<select class="form-control"  id="area" ng-model="newRace.area" ng-required="false">
								<option value="">Please Select...</option>
								<option value="South">South</option>
								<option value="Midlands">Midlands</option>
								<option value="North">North</option>
								<option value="Wales">Wales</option>
								<option value="Scotland">Scotland</option>
								<option value="Northern Ireland">Northern Ireland</option>
							</select>
						</div>
					</div>	
					<div class="form-group">
						<label class="col-sm-2 control-label" for="distance">Distance</label>
						<div class="col-sm-4">
							<select id="month" class="form-control" ng-model="newRace.distanceId"
								ng-options="d.id as d.text for d in distances" ng-required="true"></select>
						</div>
						<label class="col-sm-2 control-label" for="courseType">Course Type</label>
						<div class="col-sm-4">
								<select id="courseType" class="form-control" ng-model="newRace.courseTypeId"
									ng-options="c.id as c.description for c in courseTypes" ng-required="true"></select>
						</div>						
					</div>
					<div class="form-group">
						<label class="col-sm-2 control-label"></label>
						<div class="col-sm-10">
							<input class="btn btn-success" type="submit" value="Add">
						</div>
					</div>  
				</fieldset>
			</form>
		</div>
		<div class="panel-body" uib-collapse="collapseAddResultsForm">
			<form class="form-horizontal" ng-submit="saveResult()">
				<fieldset ng-show="race.id > 0">
					<legend>Results</legend>
					<div class="form-group">
						<label class="col-sm-2 control-label" for="name">Name</label>
						<div class="col-sm-4">
							<input class="form-control" ng-model="newResult.runner" type="text"
									uib-typeahead="r as r.name for r in currentRunners | filter:{name:$viewValue} | limitTo:8">
						</div>
					</div>
					<div class="form-group">
						<label class="col-sm-2 control-label" for="position">Position</label>
						<div class="col-sm-4">                        
							<input id="position" class="form-control" min="0" ng-model="newResult.position" ng-required="false"
									placeholder="Position" type="number">
						</div>
					</div>
					<div class="form-group">
						<label class="col-sm-2 control-label" for="time">Time</label>
						<div class="col-sm-4">
							<input id="time" class="form-control" ng-model="newResult.time" ng-required="false"
									placeholder="Time (hh:mm:ss)" type="text">
						</div>
					</div>
					 <div class="form-group">
						<label class="col-sm-2 control-label" for="team">Team</label>
						<div class="col-sm-4">
							<input id="team" class="form-control" min="0" ng-model="newResult.team" ng-required="false"
									placeholder="Team (if part of the winning team enter 1, if runner-up enter 2 etc)" type="number">
						</div>
					</div>
					<div class="form-group">
						<label class="col-sm-2 control-label" for="info">Info</label>
						<div class="col-sm-4">
								<input id="info" class="form-control" ng-model="newResult.info" ng-required="false" type="text">
						</div>
					</div>			
					<div class="form-group">
						<label class="col-sm-2 control-label"></label>
						<div class="col-sm-4">
							<input class="btn btn-success" type="submit" value="Add">
							<input class="btn btn-default" type="reset" value="Clear">
						</div>
					</div>
				</fieldset>
			</form>
        </div>
    </div>
    <div class="panel panel-default">
        <div class="panel-heading"
            ng-click="collapseSearchResultsForm = !collapseSearchResultsForm">Search results.</div>
        <div class="panel-body" uib-collapse="collapseSearchResultsForm">
            <form class="form-horizontal" ng-submit="searchResults()">
                <div class="form-group">
                    <label class="col-sm-2 control-label" for="event">Event</label>
                    <div class="col-sm-10">
                        <div class="input-group">
                            <select id="event" class="form-control" ng-model="search.eventId"
                                ng-options="e.id as e.name for e in events">
                                <option value="">Any</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-2 control-label" for="fromDate">From Date</label>
                    <div class="col-sm-10">
                        <p class="input-group">
                            <input id="fromDate" class="form-control ng-pristine ng-untouched ng-valid ng-isolate-scope ng-valid-date" close-text="Close"
                                is-open="fromCalendarStatus.opened" ng-model="search.fromDate" type="text"
                                uib-datepicker-popup="dd-MMMM-yyyy"/>
                            <span class="input-group-btn">
                                <button class="btn btn-default" ng-click="fromCalendarStatus.opened = true"
                                    type="button">
                                    <i class="glyphicon glyphicon-calendar"></i>
                                </button>
                            </span>
                        </p>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-2 control-label" for="toDate">To Date</label>
                    <div class="col-sm-10">
                        <p class="input-group">
                            <input class="form-control" close-text="Close" is-open="toCalendarStatus.opened"
                                ng-model="search.toDate" type="text" uib-datepicker-popup="dd-MMMM-yyyy"/>
                            <span class="input-group-btn">
                                <button class="btn btn-default" ng-click="toCalendarStatus.opened = true"
                                    type="button">
                                    <i class="glyphicon glyphicon-calendar"></i>
                                </button>
                            </span>
                        </p>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-2 control-label" for="limit">Maximum number of results</label>
                    <div class="col-sm-10">
                        <div class="input-group">
                            <input id="limit" min="0" ng-model="search.numberOfResults" placeholder="Limit"
                                type="number">
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="col-sm-offset-2 col-sm-10">                        
						<input class="btn btn-success" type="submit" value="Find">
                    </div>
                </div>
            </form>
		</div>
	</div>
	<div class="panel panel-default">
        <div class="panel-heading text-right">
			Search with results:
            <input ng-model="query">
        </div>		
		<div class="panel-body" cg-busy="findResultsPromise">
            <table class="table table-bordered table-hover table-condensed">
                <thead>
                    <tr>
                        <th>Event</th>
                        <th>Course</th>
                        <th>Date</th>
                        <th>Member</th>
                        <th>Position</th>
                        <th>Time</th>
                        <th>Is GP Result</th>
						<th>Team</th>
                        <th>Info</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tfoot>
                    <tr>
                        <th>Event</th>
                        <th>Course</th>
                        <th>Date</th>
                        <th>Member</th>
                        <th>Position</th>
                        <th>Time</th>
                        <th>Is GP Result</th>
						<th>Team</th>
                        <th>Info</th>
                        <th>Action</th>
                    </tr>
                </tfoot>
                <tbody>
                    <tr current-page="currentPage"
                        dir-paginate="result in results | filter:query | itemsPerPage: pageSize">
                        <td>
                            {{ showEvent(result) }}
                        </td>
                        <td>
                            {{ result.courseId }}
                        </td>
                        <td>
							<span e-name="date" e-required editable-text="result.date"
                                onbeforesave="updateResultDate($data, result)">
                                {{ result.date }}
                            </span>
							             
                        </td>
                        <td>
                            {{ showRunner(result) }}
                        </td>
                        <td>
                            <span e-name="position" e-required editable-text="result.position"
                                onbeforesave="updateResultPosition($data, result.id)">
                                {{ result.position || 'None' }}
                            </span>
                        </td>
                        <td>
                            <span e-name="time" e-required editable-text="result.time"
                                onbeforesave="updateResultTime($data, result.id)">
                                {{ result.time || 'None' }}
                            </span>
                        </td>
                        <td>
                            <a e-ng-options="s.value as s.text for s in grandPrixStatuses"
                                editable-radiolist="result.isGrandPrixResult" href="#"
                                onbeforesave="updateResultGrandPrixStatus($data, result.id)">
                                {{ showGrandPrixStatus(result.isGrandPrixResult) }}
                            </a>
                        </td>
						 <td>
                            <span e-name="team" e-required editable-text="result.team"
                                onbeforesave="updateResultTeamNumber($data, result.id)">
                                {{ result.team || 'None' }}
                            </span>
                        </td>
                        <td>
                            <span e-name="info" e-required editable-text="result.info"
                                onbeforesave="updateResultInfo($data, result.id)">
                                {{ result.info || 'None' }}
                            </span>
                        </td>
                        <td style="white-space: nowrap">
                            <div class="buttons">
                                <button class="btn btn-danger" ng-click="removeResult(result)">del</button>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <div class="text-center">
                <dir-pagination-controls auto-hide="false" boundary-links="true"
                    template-url="templates/dirPagination.tpl.html"></dir-pagination-controls>
            </div>

        </div>
    </div>
</div>